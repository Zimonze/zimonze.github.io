<!DOCTYPE html>
<html>

<head>
  <title>Mastermind</title>
  <link href="https://fonts.googleapis.com/css?family=Open+Sans&display=swap" rel="stylesheet">
  <link type="text/css" rel="stylesheet" href="style.css"/>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script>
    var rows = 6
    var pegs = 4
    var currentRow = 1
    var currentPeg = 1
    function createRow(num) {
      board = document.getElementById("board");
      var row = document.createElement("div");
      row.className += "pegs";
      row.id = num
      row.innerHTML += num
      for (n=1; n<=pegs; n++) { //1-pegs inclusive
        row.innerHTML += "<div id='"+num+"-"+n+"' class='peg'></div>";
      }
      var stones = document.createElement("div");
      stones.className += "stones";
      stones.innerHTML += "<div class='stone'></div>".repeat(4);
      var check = document.createElement("div");
      check.className += "peg peg_button check noselect";
      check.innerHTML += "CHECK";
      check.id = "check"+num;
      row.appendChild(stones);
      row.appendChild(check);
      board.appendChild(row);
    }
    function init() {
      for (i=1; i<=rows; i++) { //1-rows inclusive
        createRow(i);
      }
    }
    function step(color) {
      if (currentRow == -1) {
        return;
      }
      replacePeg(currentRow, currentPeg, color);
      if (currentPeg==pegs) {
        document.getElementById("check"+currentRow).style.display = "block";
        if (currentRow == rows) {
          currentRow = -1
        } else {
          currentRow++;
          currentPeg = 1;
        }
      } else {
        currentPeg++;
      }
    }
    function undo() {
      if (currentRow == 1 && currentPeg == 1) {
        return;
      } else if (currentRow == -1) {
        replacePeg(rows, currentPeg, "");
        currentRow = rows;
      } else if (currentPeg == 1){
        currentRow--;
        currentPeg = pegs;
        document.getElementById("check"+currentRow).style.display = "none";
        replacePeg(currentRow, currentPeg, "");
      } else if (currentPeg > 1) {
        currentPeg--;
        replacePeg(currentRow, currentPeg, "");
      }
    }
    function replacePeg(r,p,color) {
      var oldPeg = document.getElementById(r+"-"+p)
      newPeg = oldPeg.cloneNode();
      newPeg.className = "peg " + color
      document.getElementById(r).replaceChild(newPeg, oldPeg);
    }
  </script>
</head>

<body onload="init();">
  <h1>Mastermind</h1>
  <div id="board"></div>
  <hr>
  <div class="pegs">
    <div class="peg peg-button red" onclick="step('red')"></div>
    <div class="peg peg-button orange" onclick="step('orange')"></div>
    <div class="peg peg-button yellow" onclick="step('yellow')"></div>
    <div class="peg peg-button green" onclick="step('green')"></div>
    <div class="peg peg-button blue" onclick="step('blue')"></div>
    <div class="peg peg-button purple" onclick="step('purple')"></div>
    <div id="undo" class="peg peg-button noselect" onclick="undo()">UNDO</div>
  </div>
  <p>Made by Zimonze with <a href="http://repl.it">repl.it</a> and <a href="http://github.com">GitHub</a>.</p>

</body>

</html>